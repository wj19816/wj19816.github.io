---
layout: post
title: '【笔记】因子投资：方法与实践'
date: 2020-09-15
permalink: /notes/factorzoo
tags:
  - 量化投资
  - 投资
latex: true
---



# 第一章 因子投资基础

**核心公式**:

$$E(R_i^e)=\alpha_i+\beta'_i\lambda$$

**其中，$E(R_i^e)$为资产的预期超额收益，$\beta_i$是因子暴露/因子载荷，$\lambda$是因子预期收益/因子溢价。**

股票在某因子$i$上的暴露$\beta _i$反映的是在**控制了其他因子后，该目标因子的收益率变化对股票超额收益变化的影响程度**。



- 因子代表了收益率的一种结构。一旦结构给定后，个股或者任何一个投资组合的预期收益率就完全由它在这些因子上的暴露决定了——暴露高，预期收益率就高。
- **目的：如何找到这个最好的结构。**



## $\alpha_i$：异象因子

- *常用来检验是否存在异象因子*

- 存在原因：
  1. 模型设定偏误。
  2. 样本误差。
     - $\alpha_i$不是显著$\ne$0，运气
     - $\alpha_i$显著$\ne$0，**存在异象**，错误定价，可以通过套利得到超额收益。

## $\beta'_i\lambda$：定价因子

> 因子定义：一个因子描述了众多资产共同暴露的某种系统性风险，该风险是资产收益率背后的驱动力；因子收益率是这种系统性风险的风险溢价或风险补偿，是这些资产的共性收益。

- 因子满足的必要条件：
  - 因子驱动了资产收益率的共同运动，因子一定和资产收益率的协方差矩阵有关。`目前的因子模型都从金融学或经济学出发，没有直接从因子协方差矩阵和资产协方差矩阵的关系入手`
  - 长期看，因子可以获得正收益，因子必须`被定价`。
- 选择因子的原则：
  - 因子相互独立。每个因子都能对解释资产预期收益率截面差异有显著的增量贡献。
  - 简约法则。一般不超过3-5个因子。



## 时序角度

### 1. 方差模型

把$N$个资产的时序多元回归模型放在一起：

$$R_t^e=\alpha+\beta\lambda_t+\varepsilon_i$$

其中，$R_{t}^e=[R_{1t}^e，R_{2t}^e，...,R_{Nt}^e]'$是$N$维超额收益向量；$\alpha=[\alpha_1,\alpha_2,...,\alpha_N]'$是$N$维定价误差向量；$\beta=[\beta_1,\beta_2,...,\beta_N]'$是$N\times K$因子暴露矩阵；$\varepsilon_t=[\varepsilon_{1t},\varepsilon_{2t},...,\varepsilon_{Nt}]'$是$N$维随机扰动向量，满足$E[\varepsilon_t]=0$以及$cov(\lambda_t,\varepsilon_t)=0$。

得到方差模型：

$$\Sigma=\beta\Sigma_\lambda\beta'+\Sigma_\varepsilon$$

其中，$\Sigma(N阶)$为$N$个资产的协方差矩阵，$\Sigma_\lambda(K阶)$为$K$个因子的协方差矩阵，$\Sigma_\varepsilon(N阶)$为$N$个随机扰动的协方差矩阵。

- 学术界：方差模型==>*因子的选择应当使$\beta\Sigma_\lambda\beta'$尽可能接近资产协方差矩阵$\Sigma$的非对角元素。*`未来的一个重点`

- 风险控制：通过多因子模型进行降维处理。通过因子协方差矩阵反推资产收益率的协方差矩阵，从而进行风险控制。

### 2. 因子择时

> 因子溢价是对其代表的系统性风险的补偿，但在时间序列上是有波动的



## 现状与问题

**三个问题：**

1. 哪些因子是独立的？
2. 哪些因子是重要的？
3. 因子驱动资产价格的原因是什么？



### 研究目标

|                             | 学术界                                                       | 业界                                                         |
| :-------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| $\beta'_i\lambda$：定价因子 | 1. 如何找到"最好"的多因子模型：$\alpha_i→0$<br>2. 对主动基金管理人的业绩进行归因 | 使用因子来获取超过基准的收益：找到$\lambda$大的因子， 并将更高的$\beta_i$配置在因子上 |
| $\alpha_i$：异象因子        | 1. 评判市场是否有效，描述市场均衡状态的因子模型有误<br>2. 利用解释异象的能力来评价多因子模型的优劣 | 考虑交易成本后，通过异象获得超额                             |
| 时序角度                    | 1. 因子和资产协方差矩阵有关<br>2. 择时：不同因子和宏观经济及投资者情绪之间的关系 | 1. 风险控制<br>2. 因子择时：规避因子收益率较低的时刻         |



### 研究现状

- 学术界：
  - 因子独立性：提出一些分析不同因子之间相关性的分析框架
    - 提高因子显著性t值的阈值
    - 识别对真正收益率有增量贡献的因子
  - 因子表现
    - 发表后因子的样本外效果变差
    - 由于研究中没有考虑交易费用\做空限制，因此会造成对因子收益率的高估
  - 构建复合因子
  - 投资者情绪等与"人"相关的因子
  - 宏观经济因子*（但现实情况不佳）*
- 业界：
  - 收益预测vs风险管理
  - 因子拥挤
    - 任何投资策略想要持续赚钱都是利用了市场在某方面的非有效性
  - 因子择时
    - 因子估值
    - 因子动量择时
  - 区分$\alpha$和$\beta$收益
    - 20%来自异象的高$\alpha$，80%来自选择了收益率高的因子并以高暴露配置在因子上得到$\beta$收益。
  - 创新：机器学习算法等引入
- 投资者视角
  - 风格因子指数：Smart Beta ETF产品（应该把费用的高低作为唯一的标准来选择）



# 第二章 因子投资方法论

## 2.1 投资组合排序法

- 因子模拟投资组合（*最基础*）

  > *定义：使用股票资产、围绕某目标因子构建的投资组合。*
  >
  > - 条件1：该投资组合仅在目标因子上有大于0的暴露，即该组合的收益率应该仅由目标因子驱动。
  > - 条件2：在所有满足条件1的投资组合中，该组合的特质性风险最小。（避免特质性风险的影响压过目标因子，从而导致因子收益率的计算出现误差。）

  - 前提：已知因子暴露



- 排序法（*仅适用于风格因子*)

  > *核心思想：使用个股在排序变量上取值的大小来代替个股在该因子上暴露的高低。*
  >
  > > **注：变量取值$\ne$因子暴露，仅认为有一定关联。**

  - 步骤：
    1. 确定股票池，对全部股票在截面上按照排序变量排序

    2. 按排名奖所有股票分为$L$组。**做多**排名最高的第一组内的股票，同时**做空**排名最低的最后一组内的股票，得到一个多空对冲的投资组合，即**价差组合(spread portfolio)**。

       > 注：多、空两个组合的金额相同，即因子模拟投资组合是资金中性的；个股加权方式多为市值加权或等权重。

    3. 定期进行模拟投资组合的更新，即**再平衡**。
    
  - 检验：

    1. 检验因子预期收益率：
  
     $$(\hat{\lambda}=\frac{1}{T}\sum_{t=1}^T\lambda_t) ,\\ (s.e.(\hat{\lambda})=\frac{std(\lambda_t)}{\sqrt{T}}) , \\(t-value=\frac{\hat{\lambda}}{s.e.(\hat{\lambda})}\sim t(T-1))$$
  
    2. 检验$L$个投资组合的收益率单调性：$$\rho_s=\frac{cov(X_r,X_g)}{\sigma_{X_r}\sigma_{X_g}}$$
  
  - 缺点：难以控制其他因子的影响。



- 多重排序法（*经常用于研究异象*）
  - 独立双重排序
    - 步骤：使用两个排序变量分别独立地把股票进行分组，两两交集。对某一个变量，等权重做多所有排名高的投资组合，做空排名低的投资组合。
    - 缺点：可能导致某些组合中包含股票过少。
  - 条件双重排序
    - 步骤：先用$X_1$排序，再在每一个组内用$X_2$排序，进一步进行划分。（*考察控制$X_1$后，$X_2$对股票收益率的影响。*）对各层中排名最高的股票取并集，作为多头；将排名最低的股票取并集，作为空头。



## 2.2 多因子模型的回归检验

利用回归的方法检验多因子模型中因子解释异象的能力。

### 2.2.1 时间序列回归（*更适合风格因子*）

  > 以因子收益率为自变量，资产的超额收益率为因变量。

  - 步骤：
    1. 对每个资产，使用简单最小二乘对模型进行时序回归，回归得到资产$i$在因子上的暴露$\hat{\beta_i}$向量，截距$\hat{\alpha_i}$，以及残差$\epsilon_{it}$
    2. 将$R^e_{it}$和$\$在时序上取均值
- **GRS检验**：检验定价误差$\alpha_i$是否联合为0。
  - 缺点：要求残差$\epsilon_{it}$之间不能存在相关性或者异方差。
- **总结**：
  1. 因子收益时序需已知。
  2. 时序回归对每个资产单独进行，不以最小化所有$\hat{\alpha_i}$的平方和为目标。
  3. 若$\epsilon_{it}$满足iid正态分布，可以使用GRS检验，否则可以使用广义矩估计。
### 2.2.2 截面回归（*不常见，但适用性更广*）

> 首先利用时序回归确定资产的因子暴露，然后考察因子暴露与资产预期收益率在截面上的关系。

- 总结：
  1. 不要求因子的收益率时间序列已知，应用更广泛，被称为两步回归估计。
  2. 通过最小化所有资产定价误差的平方和来估计多因子模型。
- **Shanken修正**：
  - 原因：在截面回归模型中，作为解释变量的因子暴露是从时序回归中得来的，计算标准误时，需要对生成回归变量造成的误差进行修正。
- **广义最小二乘GLS**：在截面上，$\alpha_i$存在相关性，造成对标准误的低估。
- **优点**：不仅求出了每个因子的预期收益率，而且还同时得到了每个因子的投资组合。满足只对该因子有暴露，而对其他因子没有暴露。

### 2.2.3 Fama-MacBeth回归

> 非常巧妙地排除了随机扰动在截面上的相关性对标准误的影响。

- 步骤：
  1. 通过N个时间序列回归得到每个资产$i$在全部因子上的暴露$\hat{\beta_i}$向量
  2. **在每个时间点$t$，以$t$期收益率$R_{it}^e$为因变量，以$\hat{\beta_i}$为自变量进行截面回归，一共进行$T$次截面回归。**
  3. 对$T$次截面回归的$T$个估计再取平均，最终得到估计结果。
- 缺点：
  1. 对于$\alpha_i$在时序上的相关性无能为力。
  2. $\hat{\beta_i}$存在误差，仍需修正。

## 2.3 因子暴露和因子收益率

## 2.4 异象检验

## 2.5 多因子模型比较

## 2.6 因子正交化

## 2.7 广义矩估计

